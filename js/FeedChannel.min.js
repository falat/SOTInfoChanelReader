function Culture(n,t){this.Name=n,this.Language=t}function Place(n,t){this.Id=n,this.Name=t}function AppSettings(){this.instaledCultures=[new Culture("pl-PL","Polski"),new Culture("en-US","English")],this.CurentCulture="pl-PL",this.UserName="User01",this.RelativeUrl="Kanaly-uzytkownika",this.GroupsRelatiVeUrl="Kanaly-informacyjne/Grupy",this.SiteUrl="http://silesia.travel",this.SelectedTown="Katowice",this.Place=new Place(-1,""),this.UpdateInterval=1,this.OverrideLocation=!1,this.ChanelListSourceUrl=function(){return this.SiteUrl+"/"+this.CurentCulture+"/"+this.RelativeUrl+"/"+this.UserName},this.GetCurrentCulture=function(){return this.CurentCulture},this.SetCurrentCulture=function(n){this.CurentCulture=n,TranslateInterface()},this.SetAppSettings=function(){},this.OperatingSystem="blackberry",this.GetTilesSourceUrl=function(){return this.SiteUrl+"/"+this.CurentCulture+"/"+this.GroupsRelatiVeUrl}}function detectDeviceOperatingSystem(){try{var n=device.platform;if(n.indexOf("BlackBerry")!=-1)return"blackberry"}catch(t){}return"blackberry"}function LoadAppSettings(){if(window.localStorage.getItem("appSettings")){var n=JSON.parse(window.localStorage.getItem("appSettings"));appSettings.UserName=n.UserName,appSettings.SiteUrl=n.SiteUrl,appSettings.SelectedTown=n.SelectedTown,appSettings.CurentCulture=n.CurentCulture,appSettings.Place=n.Place,appSettings.OverrideLocation=n.OverrideLocation,appSettings.UpdateInterval=n.UpdateInterval,appSettings.OverrideLocation=n.OverrideLocation}TranslateInterface(),window.clearInterval(updateTimer),updateTimer=setInterval(TimerFunction(),appSettings.UpdateInterval*6e4)}function TimerFunction(){channelsLisIsUpdated=!1,tilesListIsUpdated=!1,postListForChannelIsUpdated.length=0}function T(n){var i=appSettings.GetCurrentCulture(),t;switch(i){case"en-US":t=translationPL_En}return typeof t!="undefined"&&t[n]?t[n]:n}function GSFeedPost(n,t,i,r,u,f,e){this.Id=n,this.ChannelId=f,this.Title=t,this.Descritpion=description,this.Link=r,this.Guid=u,this.Summary=e}function GSFeedChannel(n,t,i,r,u,f){this.Id=n,this.Title=t,this.Summary=i,this.Posts=[],this.link=f,this.CurrentLang=function(){return typeof u!="undefined"?languages[u]:languages[0]},this.Type=r,this.Url=function(){var n=0,t=this.link.insert(n,"/"+appSettings.GetCurrentCulture());return appSettings.OverrideLocation==!0&&(n=t.indexOf("place="),n!==-1&&(t=t.substring(0,n)+("place="+appSettings.Place.Id))),appSettings.SiteUrl+t}}function getChannelTypeFromLink(n){var t=n.lastIndexOf("type=");return n.substring(t+5,n.length)}function GSTestchannel(n,t,i){this.Id=-1,this.Title=n,this.Summary=t,this.Url=function(){return i}}function GetImageSrcForChannelType(n){switch(n){case"MicroBlog":return'<img src="images/bluesot/mikroblog.png" />';case"InfoService":return'<img src="images/bluesot/news.png" />';case"FindPoiService":return'<img src="images/bluesot/poi.png" />';case"WeatherService":return'<img src="images/bluesot/pogoda.png" />';case"Newsletter":return'<img src="images/bluesot/newsletter.png" />';case"PublicTransportService":return'<img src="images/bluesot/transport.png" />'}return'<img src="images/bluesot/news.png " />'}function RenderChannelList(n,t){var i="";$.each(n,function(n,t){i+='<li data-icon="sot-arrow">',i+='<a href="#ChannelPostListPage" class="contentLinkForChannel"   data-entryid="'+n+'" rel="external"><div class="list-item">',i+=GetImageSrcForChannelType(t.Type),i+='<div class="list-item-content">',i+='<div class="title">'+t.Title+"<\/div>",i+='<div class="summary">'+t.Summary+"<\/div>",i+="<\/div>",i+="<\/div><\/a><\/li>\n"}),$(t).html(i),$(t).listview("refresh"),console.log(T("Lista kanałów została załadowana"))}function GetChannelsList(n,t){var i=appSettings.ChanelListSourceUrl();$.ajax({url:i,success:function(n){entries=[],channelList=[];var i=$(n),r=i.find("entry");$.each(r,function(n,t){entry=new GSFeedChannel($(t).find("id").text(),$(t).find("title").text(),$(t).find("summary").text(),$(t).find("category").attr("term"),curentLangueageIndex,$(t).find("link").attr("href")),entries.push(entry)}),channelList=entries,window.localStorage.setItem("channelList",JSON.stringify(channelList)),RenderChannelList(channelList,t)},error:function(){window.localStorage.getItem("channelList")?(entries=JSON.parse(window.localStorage.getItem("channelList")),channelList=[],$.each(entries,function(n,t){entry=new GSFeedChannel(t.Id,t.Title,t.Summary,currentFeedType,curentLangueageIndex,t.link),channelList.push(entry)}),RenderChannelList(channelList,t)):($("#errorComunicate").html(T("Przepraszamy, ale nie udało się załadować informacji o dostępnych kanałach")),$.mobile.changePage($("#ErrorPage")))}})}function GetChannelListForGroup(n,t){var i=n.link;$.ajax({url:i,success:function(n){entries=[],channelList=[];var i=$(n),r=i.find("entry");$.each(r,function(n,t){entry=new GSFeedChannel($(t).find("id").text(),$(t).find("title").text(),$(t).find("summary").text(),$(t).find("category").attr("term"),curentLangueageIndex,$(t).find("link").attr("href")),entries.push(entry)}),channelList=entries,window.localStorage.setItem("channelList",JSON.stringify(channelList)),typeof t!="undefined"&&RenderChannelList(channelList,t)},error:function(){}})}function RenderChannelContent(n,t){$("#channelTitleforPostList").html(selectedChannel.Title);var r=$(GetImageSrcForChannelType(selectedChannel.Type)),i="";$.each(n,function(n,t){i+='<li data-icon="sot-arrow"><a href="#ChannelPostContentPage" class="contentLinkForPost"  data-entryid="'+n+'">',i+='<div class="post-item">',i+=r.get(0).outerHTML,i+='<div class="post-item-content">',i+='<div class="datetime">'+new Date(t.updated).format("dd.mm.yyyy HH:MM")+"<\/div>",i+='<div class="title">'+t.title+"<\/div>",i+='<div class="summary">'+t.summary.substr(0,250)+"...<\/div>",i+="<\/div>",i+="<\/div>",i+="<\/a><\/li>"}),$(t).html(i),$(t).listview("refresh"),alert("Channel Content Loaded")}function GetChannelContent(n,t){if(typeof n!="undefined"){var i=n.Url();$.ajax({url:i,success:function(i){entries=[],channelPostList=[];var r=$(i),u=r.find("entry");$.each(u,function(n,t){entry={title:$(t).find("title").text(),link:$(t).find("link").text(),guid:$(t).find("guid").text(),description:$.trim($(t).find("description").text()),summary:$(t).find("summary").text(),content:$(t).find("content").text(),updated:$(t).find("updated").text()},entries.push(entry)}),channelPostList=entries,window.localStorage.setItem("channelPostList"+n.Id,JSON.stringify(channelPostList)),typeof t!="undefined"&&RenderChannelContent(channelPostList,t)},error:function(){window.localStorage.getItem("channelPostList"+n.Id)?(channelPostList=JSON.parse(window.localStorage.getItem("channelPostList"+n.Id)),RenderChannelContent(channelPostList,t)):($("#errorComunicate").html(T("Przepraszamy, ale nie udało się załadować listy postów dla wybranego kanału")),$.mobile.changePage($("#ErrorPage")))}})}else console.error(T("Nie zdefiniowany kanał rss"))}function GetPostContent(n){$("#channelTitleforPost").html(selectedChannel.Title);var t=channelPostList[n],i="<h1>"+t.title+"<\/h1>";i+="<article>"+t.content+"<\/article>",$("#postContent").html(i)}function getRandomInt(n,t){return Math.floor(Math.random()*(t-n+1))+n}function delay(n){var i=new Date,t=null;do t=new Date;while(t-i<n)}function getRandomDirection(){return"vertical"}function getRandomColor(){var n=["teal","red","violet","pink","orange","olive","green","cyan","blue"],t=getRandomInt(0,n.length-1);return n[t]}function getRandomTileMode(){return getRandomInt(0,1)>0?"slide":"flip"}function selectTileClick(n){isGroupSelected=!0,selectedGroup=tilesList[n]}function selectUserChannelsListClick(){isGrooupSelected=!1}function AddTile(n,t){var e=$("<a />",{href:"#ChannelsListPage"}),i=$("<div />"),o,r,u,f;i.addClass("live-tile"),i.addClass(t.color),i.attr("onclick","selectTileClick("+t.index+")"),o=getRandomInt(5,10)*1e3,r=t.data,typeof r=="undefined"&&(r=[{name:"stops",value:"100%"},{name:"speed",value:"750"},{name:"delay",value:o},{name:"mode",value:"slide"},{name:"direction",value:getRandomDirection()}]),$.each(r,function(n,t){i.attr("data-"+t.name,t.value)}),t.frontText&&(u=$("<div>"+t.frontText+"<\/div>")),t.backText&&(f=$("<div>"+t.backText+"<\/div>")),t.frontImageUrl&&$('<img src="'+t.frontImageUrl+'" />').appendTo(u),t.backImageUrl&&$('<img src="'+t.backImageUrl+'" />').appendTo(f),u&&u.appendTo(i),f&&f.appendTo(i),$(i).liveTile(),i.appendTo(e),e.appendTo(n)}function AddCarouselTile(n,t,i){var f=$('<div class="channelGroupTile" data-entryid="'+t.index+'"/>'),e,u;f.addClass(t.color);var o=$("<a />",{href:"#ChannelsListPage"}),s=[{name:"delay",value:getRandomInt(3e3,5e3)},{name:"mode",value:"carousel"},{name:"direction",value:getRandomDirection()},{name:"start-now",value:"true"}],r=$("<div />");r.addClass("live-tile"),$.each(s,function(n,t){r.attr("data-"+t.name,t.value)});for(e in i)u=$('<div class="metroExtraSmall" />'),u.addClass(i[e].Type),$("<p>"+i[e].Title+"<\/p>").appendTo(u),$('<div class="courtin-div '+t.color+'" >  <\/div>').appendTo(u),u.appendTo(r);$(r).liveTile({animationComplete:function(n,t){var i=t.children(".courtin-div");i.fadeTo(1,.2),i.fadeTo(2e3,1)}}),r.appendTo(o),o.appendTo(f),f.appendTo(n)}function RenderTilesList(n,t){var i={};$(t).html(""),$.ajaxSetup({async:!1}),$.each(n,function(n,r){i.index=n,i.link=r.link,i.frontText="<span>"+r.Title+'<\/span><span class="tile-title"><ul>',GetChannelListForGroup(r),entries=JSON.parse(window.localStorage.getItem("channelList"));for(var u in entries)i.frontText+="<li>"+entries[u].Title+"<\/li>";i.frontText+="<\/span><\/ul>",i.color=getRandomColor(),i.data=[{name:"stops",value:"100%"},{name:"mode",value:"nomove"},],AddCarouselTile(t,i,entries)}),$(".channelGroupTile").live("click",function(){selectedEntry=$(this).data("entryid"),isGroupSelected=!0,selectedGroup=n[selectedEntry]}),$.ajaxSetup({async:!0})}function GetTilesList(n){var t=appSettings.GetTilesSourceUrl();tilesListIsUpdated?(window.localStorage.setItem("tilesList",JSON.stringify(tilesList)),RenderTilesList(tilesList,n)):$.ajax({url:t,timeout:5e3,success:function(t){entries=[],tilesList=[];var i=$(t),r=i.find("entry");$.each(r,function(n,t){entry=new GSFeedChannel($(t).find("id").text(),$(t).find("title").text(),$(t).find("summary").text(),$(t).find("category").attr("term"),curentLangueageIndex,$(t).find("link").attr("href")),entries.push(entry)}),tilesList=entries,window.localStorage.setItem("tilesList",JSON.stringify(tilesList)),RenderTilesList(tilesList,n),tilesListIsUpdated=!0},error:function(t){t.status!=0&&(window.localStorage.getItem("tilesList")?(tilesList=[],entries=JSON.parse(window.localStorage.getItem("tilesList")),$.each(entries,function(n,t){entry=new GSFeedChannel(t.Id,t.Title,t.Summary,currentFeedType,curentLangueageIndex,t.link),tilesList.push(entry)}),RenderTilesList(tilesList,n)):console.log(T("Przepraszamy, ale nie udało się załadować informacji o dostępnych kanałach na stronie głównej")))}})}function LoadLanguagesToDropDown(n){$(n).html("");var t=$(n);$.each(instaledCultures,function(t,i){var r=!1,u;i.Name==appSettings.CurentCulture&&(r=!0,$(n)[0].selectedIndex=t+1),u=new Option(T(i.Language),i.Name,r,r),$(n).append(u)})}function TranslateInterface(){var t=document.querySelectorAll("[data-to-display]"),n,r;for(i=0;i<t.length;i++)n=t[i],r=n.getAttribute("data-to-display"),n.innerHTML=T(r);$.mobile.loadingMessage=T("Wczytywanie")}function ApplicationInitialization(){$.ajaxSetup({timeout:15e3,error:function(n){var t;t=n.status==0?T(" Check Your Network."):n.status==404?T("Requested URL not found."):n.status==500?T("Internel Server Error."):T("Unknow Error.\n"),$("#errorComunicate").html(t),$.mobile.changePage($("#ErrorPage"),{transition:"pop",changeHash:!1})}}),TranslateInterface(),$(".live-tile, .flip-list").not(".exclude").liveTile(),LoadAppSettings(),$.mobile.changePage.defaults.allowSamePageTransition=!0}function setupAutoComplete(){var n=appSettings.SiteUrl+"/Dictionaries/LocationPicker/GetPlaceLocations";$("#placeSearch").autocomplete({target:$("#placeSuggestions"),source:n,callback:function(n){var t=$(n.currentTarget);tmpPlace.Id=t.data("autocomplete").placeId,tmpPlace.Name=t.data("autocomplete").value,typeof appSettings.Place.Id=="undefined"&&(tmpPlace.Id=-1,tmpPlace.Name=""),$("#placeSearch").val(tmpPlace.Name),$("#placeSearch").autocomplete("clear")},labelHTML:function(n){return n},builder:buildItemsForPlaces,link:"target.html?term=",minLength:3})}function getLocation(){var n=document.getElementById("geoLocationArea");navigator.geolocation?(navigator.geolocation.getCurrentPosition(showPosition,geolocationError,{maximumAge:3e3,timeout:5e3,enableHighAccuracy:!0}),n.innerHTML=T("Localization procedure is running.")):n.innerHTML=T("Geolocation is not supported by this browser.")}function showPosition(n){$("#latValue").html(n.coords.latitude),$("#lngValue").html(n.coords.longitude),$("#accuracyValue").html(n.coords.accuracy);var t=$("#geoLocationArea");t.html("Latitude: "+n.coords.latitude+"<br>Longitude: "+n.coords.longitude)}function geolocationError(n){var t=$("#geoLocationArea");t.html(T("Błąd w trkacie ustalania lokalizacji: ")+"code: "+n.code+" message: "+n.message+"\n")}function openLinkInExternalBrowser(n){navigator.app.loadUrl(n),window.plugins.childBrowser.showWebPage(n,{showLocationBar:!0})}var languages=["pl-PL","en-US","de-De","ru-RU"],curentLangueageIndex=0,currentFeedType="RSS",silesiaTravelUrl="http://sot.global-it.pl",channelList=[],entries=[],selectedEntry="",channelPostList=[],selectedChannel,selectedPostIndex,tilesList=[],tilesListIsUpdated=!1,channelsListIsUpdated=!1,postListForChannelIsUpdated=[],updateTimer,isGroupSelected=!1,selectedGroup,instaledCultures=[new Culture("pl-PL","Polski"),new Culture("en-US","English")],tmpPlace=new Place(-1,""),appSettings=new AppSettings,idx,app;String.prototype.insert=function(n,t){return n>0?this.substring(0,n)+t+this.substring(n,this.length):t+this},$("#MainPage").live("pageshow",function(){GetTilesList("#dynamicTiles"),isGroupSelected=!0}),$("#ChannelsListPage").live("pagebeforeshow",function(){$("#ChannelsListView").html("")}),$("#ChannelsListPage").live("pageshow",function(){isGroupSelected?GetChannelListForGroup(selectedGroup,"#ChannelsListView"):GetChannelsList("userName","#ChannelsListView"),$("#ChannelsListView").listview("refresh")}),$("#ChannelPostListPage").live("pagebeforeshow",function(){$("#channelTitleforPostList").html(""),$("#channelPostList").html("")}),$("#ChannelPostListPage").live("pageshow",function(){GetChannelContent(selectedChannel,"#channelPostList"),$("#channelPostList").listview("refresh")}),$("#ChannelPostContentPage").live("pagebeforeshow",function(){$.mobile.showPageLoadingMsg(),$("#postContent").html("")}),$("#ChannelPostContentPage").live("pageshow",function(){GetPostContent(selectedEntry),$.mobile.hidePageLoadingMsg()}),$("#UserSettingsPage").live("pageshow",function(){LoadAppSettings(),LoadLanguagesToDropDown("#languageSelect"),setupAutoComplete(),$("#userNameInp").val(appSettings.UserName),$("#siteUrlInp").val(appSettings.SiteUrl),$("#languageSelect").selectmenu("refresh"),tmpPlace.Id=appSettings.Place.Id,tmpPlace.Name=appSettings.Place.Name,$("#placeSearch").val(appSettings.Place.Name),$('input[id="overrideLocationChechBox"]').attr("checked",appSettings.OverrideLocation).checkboxradio("refresh")}),$(".contentLinkForChannel").live("click",function(){selectedEntry=$(this).data("entryid"),selectedChannel=channelList[selectedEntry]}),$(".contentLinkForPost").live("click",function(){selectedEntry=$(this).data("entryid"),selectedPostIndex=selectedEntry}),$("#userChannels").live("click",function(){isGroupSelected=!1}),$(".refresh-button").live("click",function(){tilesListIsUpdated=!1,channelsListIsUpdated=!1,postListForChannelIsUpdated=[]}),$(document).ajaxStart(function(){$.mobile.loading("show")}),$("#applySettingsBtn").live("click",function(){appSettings.UserName=$("#userNameInp").val(),appSettings.SiteUrl=$("#siteUrlInp").val(),appSettings.Place=new Place(tmpPlace.Id,tmpPlace.Name);var n=$("#languageSelect").val();appSettings.SetCurrentCulture(n),appSettings.OverrideLocation=$("#overrideLocationChechBox").is(":checked"),window.localStorage.setItem("appSettings",JSON.stringify(appSettings))}),$("#appExitBtn").live("click",function(){if($.mobile.activePage.is("#MainPage")){var n=detectDeviceOperatingSystem();n=="blackberry"?blackberry.app.exit():navigator.app.exitApp()}else navigator.app.backHistory()}),$(document).ajaxStop(function(){$.mobile.loading("hide")}),buildItemsForPlaces=function(n,t){var i=[];return n&&$.each(n,function(n,r){$.isPlainObject(r)?i.push("<li data-icon="+t.icon+'><a href="'+t.link+encodeURIComponent(r.value)+'" data-transition="'+t.transition+"\" data-autocomplete='"+JSON.stringify(r)+"'>"+t.labelHTML(r.value)+"<\/a><\/li>"):i.push("<li data-icon="+t.icon+'><a href="'+t.link+encodeURIComponent(r)+'" data-transition="'+t.transition+'">'+t.labelHTML(r)+"<\/a><\/li>")}),$.isArray(i)&&(i=i.join("")),i},idx=0,app={initialize:function(){ApplicationInitialization(),this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1),document.addEventListener("backbutton",function(n){$.mobile.activePage.is("#homepage")?(n.preventDefault(),navigator.app.exitApp()):navigator.app.backHistory()},!1)},onDeviceReady:function(){app.receivedEvent("deviceready")},receivedEvent:function(n){console.log("Received Event: "+n)}};
//@ sourceMappingURL=FeedChannel.min.js.map